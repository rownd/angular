# Angular

## Installation

run `npm install @rownd/angular` or `yarn add @rownd/angular`

Make sure to add the preserveSymlinks property to the angular.json file
```json
{
  "projects": {
    "app": {
      "architect": {
        "build": {
          "options": {
            "preserveSymlinks": true,
          }
        }
      }
    }
  }
}
```

## Usage

The library provides a Rownd Module and Dependency Injection (Service).

In the main app.module.ts file, add the Rownd Module. Please include the @ngrx/store Module as well.

```ts
import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { AppRoutingModule } from './app-routing.module';

import { StoreModule } from '@ngrx/store';
import { RowndModule } from '@rownd/angular';

@NgModule({
  declarations: [AppComponent],
  imports: [
    BrowserModule,
    AppRoutingModule,
    StoreModule.forRoot({}),
    RowndModule.forRoot({ appKey: '<your app key>' }),
  ],
  providers: [],
  bootstrap: [AppComponent],
})
export class AppModule {}
```

### Module params
* `appKey` (required): This is the key generated by the [Rownd dashboard](https://app.rownd.io).

## Usage within a Component

```ts
import { Component } from '@angular/core';
import { RowndService } from '@rownd/angular';

@Component({
  selector: 'protected-component',
  templateUrl: 'protected.component.html',
  styleUrls: ['protected.component.scss'],
})
export class ProtectedComponent {

  constructor(private rownd: RowndService) {
    //Subscribe to Rownd isAuthenticated observable
    this.rownd.isAuthenticated$.subscribe({
      next(auth) {
        console.log("is Authenticated: ", auth)
      }
    });

    //Subscribe to Rownd User Data observable
    this.rownd.user$.subscribe({
      next(user) {
        console.log("user: ", user)
      }
    });
  }

  signIn() {
    this.rownd.requestSignIn();
  }

  signOut() {
    this.rownd.signOut();
  }
} 
```




## API Reference

#### requestSignIn()

Trigger the Rownd sign in Dialog

```ts
import { RowndService } from '@rownd/angular';

constructor(private rownd: RowndService) {}

this.rownd.requestSignIn()
```


#### signOut()

Sign out the user and clear their profile, returning them to a completely unauthenticated state.

```ts
import { RowndService } from '@rownd/angular';

constructor(private rownd: RowndService) {}

this.rownd.signOut()
```

#### is_authenticated

indicates whether the current user is signed in or not.

```ts
import { RowndService } from '@rownd/angular';

constructor(private rownd: RowndService) {}

//user$ is an observable
this.rownd.user$
```

#### isAuthenticated

indicates whether the current user is signed in or not.

```ts
import { RowndService } from '@rownd/angular';

constructor(private rownd: RowndService) {}

//isAuthenticated$ is an observable
this.rownd.isAuthenticated$
```

#### user

Represents information about the current user, specifically their profile information.

```ts
import { RowndService } from '@rownd/angular';

constructor(private rownd: RowndService) {}

//user$ is an observable
this.rownd.user$
```

#### isInitializing

is_initializing will be true until the Hub has fully loaded, recalled its state, and resolved the current user's authentication status. This usually takes only a few milliseconds, but if you make decisions that depend on the is_authenticated flag while is_initializing is still true, your code/logic may not work as you expect.

```ts
import { RowndService } from '@rownd/angular';

constructor(private rownd: RowndService) {}

//isInitializing$ is an observable
this.rownd.isInitializing$
```
